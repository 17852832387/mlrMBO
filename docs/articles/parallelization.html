<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title> • mlrMBO</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">mlrMBO</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/mlrMBO.html">Quickstart</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/mlr-org/mlrMBO">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1></h1>
            
          </div>

    
    
<div class="contents">
<div id="work-in-progress" class="section level1">
<h1 class="hasAnchor">
<html><body><a href="#work-in-progress" class="anchor"> </a></body></html>Work in progress!</h1>
</div>
<div id="parallelization" class="section level1">
<h1 class="hasAnchor">
<html><body><a href="#parallelization" class="anchor"> </a></body></html>Parallelization</h1>
<div id="argument-method" class="section level4">
<h4 class="hasAnchor">
<html><body><a href="#argument-method" class="anchor"> </a></body></html>Argument: <em>method</em>
</h4>
<p>Define the method used for multipoint proposals, currently 3 different methods are supported:</p>
<ul>
<li>
<code>cb</code>: Proposes multiple points by optimizing the confidence bound criterion <code>propose.points</code> times with different lambda values. Generally this works the same way as for the single point case, i.e. specify <code>infill.opt</code>. The lambdas are drawn from an exp(1)-distribution.</li>
<li>
<code>multicrit</code>: Use a evolutionary multicriteria optimization. This is a (mu+1) type evolutionary algorithm and runs for <code>multicrit.maxit</code> generations. The population size is set to <code>propose.points</code>.</li>
<li>
<code>cl</code>: Proposes points by the constant liar strategy, which only makes sense if the confidence bound criterion is used as an infill criterion. In the first step the surrogate model is fitted based on the real data and the best point is calculated accordingly. Then, the function value of the best point is simply guessed by the worst seen function evaluation. This “lie”" is used to update the model in order to propose subsequent point. The procedure is applied until the number of points has reached <code>propose.points</code>.</li>
</ul>
<p>It is possible to parallelize the evaluation of the target function to speed up the computation. Internally the evaluation of the target function is realized with the R package <code>parallelMap</code>. This package offers simple parallelization with various different backends. For details on the usage see the <a href="https://github.com/berndbischl/parallelMap#parallelmap">parallelMap github page</a>, which offers a nice tutorial and describes all possible backends thorougly. For our usage we use a <em>multicore</em> backend. Note, that the multicore parallelization does <em>not</em> work on windows machines.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(mlrMBO)
<span class="kw">library</span>(parallelMap)

obj.fun =<span class="st"> </span><span class="kw">makeSphereFunction</span>(<span class="dv">1</span>)
learner =<span class="st"> </span><span class="kw">makeLearner</span>(<span class="st">"regr.km"</span>, <span class="dt">predict.type =</span> <span class="st">"se"</span>, <span class="dt">covtype =</span> <span class="st">"matern3_2"</span>)
control =<span class="st"> </span><span class="kw"><a href="../reference/makeMBOControl.html">makeMBOControl</a></span>()
control =<span class="st"> </span><span class="kw"><a href="../reference/setMBOControlTermination.html">setMBOControlTermination</a></span>(control, <span class="dt">iters =</span> <span class="dv">3</span>)
design =<span class="st"> </span><span class="kw">generateDesign</span>(<span class="dt">n =</span> <span class="dv">6</span>, <span class="dt">par.set =</span> <span class="kw">getParamSet</span>(obj.fun))

<span class="kw">parallelStartMulticore</span>(<span class="dt">cpus =</span> <span class="dv">2</span>) <span class="co"># use 2 CPUs</span>
res =<span class="st"> </span><span class="kw"><a href="../reference/mbo.html">mbo</a></span>(obj.fun, <span class="dt">learner =</span> learner, <span class="dt">control =</span> control)
<span class="kw">parallelStop</span>()</code></pre></div>
<p>Since mbo is a sequential method we cannot gain any improvement in the running time in this setup. But there are multiple two situations in which parallelization can be utilized <em>noisy functions</em> and <em>multi point proposals</em>.</p>
</div>
<div id="noisy-functions" class="section level2">
<h2 class="hasAnchor">
<html><body><a href="#noisy-functions" class="anchor"> </a></body></html>Noisy functions</h2>
<p>If our target function is not deterministic (e.g. the accuracy of a machine learning model) it is advisable to take the crossvalidation error. For the crossvalidation error, the model is fitted multuple times on slightly different training data. This process can be easily parallelized with <code>parallelMap</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(mlr)

fn =<span class="st"> </span>function(x) {
  lrn =<span class="st"> </span><span class="kw">makeLearner</span>(<span class="st">"classif.ksvm"</span>, <span class="dt">par.vals =</span> x)
  
  rdesc =<span class="st"> </span><span class="kw">makeResampleDesc</span>(<span class="st">"CV"</span>, <span class="dt">iters =</span> 10L)
  
  res =<span class="st"> </span><span class="kw">resample</span>(<span class="dt">learner =</span> lrn, iris.task, rdesc, <span class="dt">show.info =</span> <span class="ot">FALSE</span>)
  
  res$aggr
}


par.set =<span class="st"> </span><span class="kw">filterParams</span>(mlr::<span class="kw">getParamSet</span>(<span class="st">"classif.ksvm"</span>), <span class="dt">ids =</span> <span class="kw">c</span>(<span class="st">"C"</span>, <span class="st">"sigma"</span>))

par.set =<span class="st"> </span><span class="kw">makeParamSet</span>(<span class="kw">makeNumericParam</span>(<span class="st">"C"</span>, <span class="dt">lower =</span> -<span class="dv">10</span>, <span class="dt">upper =</span> <span class="dv">10</span>, <span class="dt">trafo =</span> function(x) <span class="dv">2</span>^x),
                       <span class="kw">makeNumericParam</span>(<span class="st">"sigma"</span>, <span class="dt">lower =</span> -<span class="dv">10</span>, <span class="dt">upper =</span> <span class="dv">10</span>, <span class="dt">trafo =</span> function(x) <span class="dv">2</span>^x))

obj.fun =<span class="st"> </span><span class="kw">makeSingleObjectiveFunction</span>(<span class="dt">name =</span> <span class="st">"noisy_example"</span>,
                                      <span class="dt">fn =</span> fn,
                                      <span class="dt">has.simple.signature =</span> <span class="ot">FALSE</span>,
                                      <span class="dt">par.set =</span> par.set)


control =<span class="st"> </span><span class="kw"><a href="../reference/makeMBOControl.html">makeMBOControl</a></span>()
control =<span class="st"> </span><span class="kw"><a href="../reference/setMBOControlTermination.html">setMBOControlTermination</a></span>(control, <span class="dt">iters =</span> 10L)

design =<span class="st"> </span><span class="kw">generateDesign</span>(<span class="dt">n =</span> <span class="dv">10</span>, <span class="kw">getParamSet</span>(obj.fun), <span class="dt">trafo =</span> <span class="ot">TRUE</span>)

<span class="kw">parallelStartMulticore</span>(<span class="dt">cpus =</span> 4L)
<span class="kw"><a href="../reference/exampleRun.html">exampleRun</a></span>(obj.fun, <span class="dt">design =</span> design, <span class="dt">control =</span> control)
<span class="kw">parallelStop</span>()</code></pre></div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#work-in-progress">Work in progress!</a></li>
      <li>
<a href="#parallelization">Parallelization</a><ul class="nav nav-pills nav-stacked">
<li><a href="#noisy-functions">Noisy functions</a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Bernd Bischl, Jakob Bossek, Jakob Richter, Daniel Horn, Michel Lang, Janek Thomas.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
